---
phase: 03-security-error-handling
plan: 05
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/frontend/src/components/ErrorBoundary.tsx
  - packages/frontend/src/components/Toast.tsx
  - packages/frontend/src/main.tsx
  - packages/frontend/src/pages/admin/AdminPrompts.tsx
  - packages/frontend/src/pages/admin/AdminJobs.tsx
  - packages/frontend/src/pages/admin/AdminUsers.tsx
  - packages/frontend/src/pages/Resume.tsx
  - packages/frontend/src/components/WorkExperience.tsx
  - packages/frontend/src/components/Education.tsx
autonomous: true
requirements:
  - ERR-03
  - ERR-04

must_haves:
  truths:
    - "All alert() calls in packages/frontend are replaced with toast notifications"
    - "All confirm() calls in packages/frontend are replaced with inline confirmation UI"
    - "Success toasts appear top-right for 3 seconds, error toasts for 5 seconds"
    - "Error toasts include a Retry action button where appropriate"
  artifacts:
    - path: "packages/frontend/src/components/ErrorBoundary.tsx"
      provides: "Reusable error boundary wrapper for frontend package"
      exports: ["ErrorFallback"]
    - path: "packages/frontend/src/components/Toast.tsx"
      provides: "Toast provider wrapper for frontend package"
  key_links:
    - from: "packages/frontend/src/pages/admin/AdminPrompts.tsx"
      to: "sonner"
      via: "toast.success/toast.error replace alert() calls"
      pattern: "toast\\.(success|error)"
    - from: "packages/frontend/src/main.tsx"
      to: "sonner"
      via: "Toaster component rendered in app root"
      pattern: "Toaster"
---

<objective>
Add React error boundaries and toast notifications to the packages/frontend app — create shared ErrorBoundary and Toast components, and replace all alert()/confirm() calls in admin pages and resume components.

Purpose: Close ERR-03 (error boundaries) and ERR-04 (user-friendly error notifications) for the packages/frontend app. This is the companion plan to 03-04 which covers the rwsdk app.

Output: ErrorBoundary and Toast infrastructure in packages/frontend. All alert() replaced with toast notifications. All confirm() replaced with inline confirmation UI. Zero blocking browser dialogs in the frontend package.
</objective>

<execution_context>
@/home/carl/.claude/get-shit-done/workflows/execute-plan.md
@/home/carl/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-security-error-handling/03-RESEARCH.md

@packages/frontend/src/main.tsx
@packages/frontend/src/pages/admin/AdminPrompts.tsx
@packages/frontend/src/pages/admin/AdminJobs.tsx
@packages/frontend/src/pages/admin/AdminUsers.tsx
@packages/frontend/src/pages/Resume.tsx
@packages/frontend/src/components/WorkExperience.tsx
@packages/frontend/src/components/Education.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ErrorBoundary and Toast components for packages/frontend</name>
  <files>
    packages/frontend/src/components/ErrorBoundary.tsx
    packages/frontend/src/components/Toast.tsx
    packages/frontend/src/main.tsx
  </files>
  <action>
**Install dependencies:**
```bash
npm install react-error-boundary sonner --workspace=packages/frontend
```

**Create `packages/frontend/src/components/ErrorBoundary.tsx`:**

Same ErrorFallback component as the rwsdk version (no `"use client"` needed — standard React app):
- Simple message + retry button, no illustrations
- Friendly casual tone: "Oops, something went wrong! Let's try that again."
- Console-only error logging (no external reporting)
- Styled with Tailwind: centered text, muted colors, rounded border, padding

```tsx
import { ErrorBoundary } from 'react-error-boundary';
import type { FallbackProps } from 'react-error-boundary';

export function ErrorFallback({ error, resetErrorBoundary }: FallbackProps) {
  console.error('[ErrorBoundary]', error);
  return (
    <div className="p-6 rounded-lg border border-gray-200 text-center">
      <p className="text-gray-600 mb-4">
        Oops, something went wrong! Let&apos;s try that again.
      </p>
      <button
        onClick={resetErrorBoundary}
        className="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"
      >
        Retry
      </button>
    </div>
  );
}

export { ErrorBoundary };
```

**Create `packages/frontend/src/components/Toast.tsx`:**

```tsx
import { Toaster } from 'sonner';

export function ToastProvider() {
  return <Toaster position="top-right" richColors />;
}

export { toast } from 'sonner';
```

**Update `packages/frontend/src/main.tsx`:**
Add `<ToastProvider />` inside the root component tree (after QueryClientProvider, inside the React tree).
  </action>
  <verify>
Run `npx tsc --noEmit` in packages/frontend. Verify:
- `ls packages/frontend/src/components/ErrorBoundary.tsx packages/frontend/src/components/Toast.tsx`
- `grep -n "Toaster\|ToastProvider" packages/frontend/src/main.tsx`
  </verify>
  <done>
ErrorBoundary and Toast components exist in packages/frontend. Toaster is mounted in the app root. react-error-boundary and sonner are installed.
  </done>
</task>

<task type="auto">
  <name>Task 2: Replace all alert/confirm calls in packages/frontend pages and components</name>
  <files>
    packages/frontend/src/pages/admin/AdminPrompts.tsx
    packages/frontend/src/pages/admin/AdminJobs.tsx
    packages/frontend/src/pages/admin/AdminUsers.tsx
    packages/frontend/src/pages/Resume.tsx
    packages/frontend/src/components/WorkExperience.tsx
    packages/frontend/src/components/Education.tsx
  </files>
  <action>
**Replace alert() calls — admin pages:**

- AdminPrompts.tsx lines ~46, 58, 98, 107: Replace 4x `alert()` with `toast.success()` or `toast.error()` as appropriate. Import from `sonner` or local Toast wrapper. Success messages get default 3s duration, errors get 5s.
- AdminJobs.tsx lines ~42, 52, 63: Replace 3x `alert()` with toast notifications.

**Replace confirm() calls — admin pages:**

- AdminUsers.tsx line ~52: Replace `confirm()` with inline confirmation UI. Add a `confirmingId` state variable. When the action is clicked, set the ID. Show "Are you sure? [Confirm] [Cancel]" inline instead of the action button. On confirm, execute the action. On cancel, clear the state.

**Replace confirm() calls — resume components:**

- Resume.tsx line ~205: Replace `confirm()` with inline confirmation state.
- WorkExperience.tsx line ~238: Replace `confirm()` with inline confirmation state.
- Education.tsx line ~240: Replace `confirm()` with inline confirmation state.

**Inline confirmation pattern (reusable across all components):**

```tsx
const [confirmingDeleteId, setConfirmingDeleteId] = useState<string | null>(null);

// In the render, where the delete button is:
{confirmingDeleteId === item.id ? (
  <div className="flex items-center gap-2">
    <span className="text-sm text-gray-500">Delete?</span>
    <button onClick={() => { handleDelete(item.id); setConfirmingDeleteId(null); }}
      className="text-sm text-red-600 hover:text-red-800">Confirm</button>
    <button onClick={() => setConfirmingDeleteId(null)}
      className="text-sm text-gray-400 hover:text-gray-600">Cancel</button>
  </div>
) : (
  <button onClick={() => setConfirmingDeleteId(item.id)}>Delete</button>
)}
```

**Toast behavior per user decision:**
- Success: 3 seconds (sonner default or explicit `duration: 3000`)
- Error: 5 seconds (`duration: 5000`)
- Include Retry action button on failure toasts where a retry function is available
- Position: top-right (set on Toaster component in Task 1)

IMPORTANT: Check that NO alert() or confirm() calls remain after changes: `grep -rn "alert(\|confirm(" packages/frontend/src/`
  </action>
  <verify>
Run `npx tsc --noEmit` in packages/frontend. Verify:
- `grep -rn "toast\." packages/frontend/src/pages/ packages/frontend/src/components/`
- Confirm zero alert/confirm calls remain: `grep -rn "alert(\|confirm(" packages/frontend/src/pages/ packages/frontend/src/components/` should return nothing (or only comments)
  </verify>
  <done>
All alert() calls in packages/frontend are replaced with toast notifications. All confirm() calls are replaced with inline confirmation UI. Zero blocking browser dialogs remain in the frontend package.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes in packages/frontend
2. Zero alert() or confirm() calls remain in packages/frontend/src/
3. Toaster component is mounted in the frontend app root
4. Toast notifications follow user-specified behavior (top-right, 3s/5s, action buttons)
5. Inline confirmation UI replaces all confirm() dialogs
</verification>

<success_criteria>
- Admin action success/failure shows toast notifications instead of browser alerts
- Deleting a user in AdminUsers shows inline "Are you sure?" confirmation
- Deleting work experience or education shows inline confirmation
- No alert() or confirm() calls remain in packages/frontend code
- TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/03-security-error-handling/03-05-SUMMARY.md`
</output>
